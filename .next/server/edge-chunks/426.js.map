{"version":3,"file":"edge-chunks/426.js","mappings":"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","sources":["webpack://_N_E/./server/promptTemplates.ts","webpack://_N_E/./server/score.ts","webpack://_N_E/./app/api/analyze/route.ts"],"sourcesContent":["export const researchPrompt = ({ role, tasks, resume, linkedinData, profileData }: any) => `\nYou are an AI researcher conducting comprehensive analysis of AI automation risk for: ${role}.\n\n**ROLE CONTEXT:**\n- Position: ${role}\n- Weekly task breakdown: ${JSON.stringify(tasks)}\n- Professional background: ${resume?.slice(0, 800)}\n${linkedinData ? `- LinkedIn Analysis: ${JSON.stringify(linkedinData)}` : ''}\n${profileData ? `- Additional Profile Data: ${JSON.stringify(profileData)}` : ''}\n\n**CRITICAL REQUIREMENT: REAL SOURCES ONLY**\nYou must ONLY reference verifiable sources that actually exist. Do not create fake URLs, company names, or statistics. If you cannot find current information, state that research is limited and focus on general AI automation trends you know are accurate.\n\n**RESEARCH REQUIREMENTS:**\nFor each major task category, provide:\n1. **Risk Assessment**: High (actively automated) | Moderate (tools emerging) | Low (human-centric)\n2. **Evidence**: Real AI tools/companies you know exist (OpenAI, Anthropic, Microsoft, Google, etc.)\n3. **Timeline**: Conservative estimates based on actual technology progress\n4. **Sources**: ONLY real URLs you're certain exist, or reference organization names without URLs\n\n**ACCEPTABLE REAL SOURCES:**\n- OpenAI, Anthropic, Microsoft, Google official announcements\n- McKinsey Global Institute, MIT Technology Review, Stanford AI Index\n- Bureau of Labor Statistics, World Economic Forum reports\n- Major tech publications (TechCrunch, Wired, MIT Technology Review)\n- If uncertain about URLs, use format: \"Organization Name Research\" instead\n\n**OUTPUT FORMAT - RETURN VALID JSON ONLY:**\n{\n  \"taskFacts\": [\n    {\n      \"task\": \"specific task from their role\",\n      \"riskLevel\": \"High|Moderate|Low\", \n      \"evidence\": \"real AI tools/companies affecting this (actual names only)\",\n      \"impact\": \"conservative automation percentage estimate\",\n      \"timeline\": \"realistic timeframe for significant impact\",\n      \"sourceUrl\": \"real URL only if certain it exists, otherwise 'Industry research'\",\n      \"toolsExample\": \"actual AI tools/platforms you know exist\"\n    }\n  ],\n  \"macroStats\": [\n    {\n      \"statistic\": \"verifiable industry data or conservative estimates\",\n      \"source\": \"real research organization name\",\n      \"url\": \"real URL only if certain, otherwise 'Industry research reports'\",\n      \"year\": \"2023 or 2024\",\n      \"relevance\": \"how this relates to the specific role\"\n    }\n  ],\n  \"industryContext\": {\n    \"overview\": \"2-3 sentence summary based on real AI developments\",\n    \"keyTrends\": [\"real trend 1\", \"real trend 2\", \"real trend 3\"],\n    \"timeHorizon\": \"conservative timeline for major disruption\"\n  }\n}\n\nFocus on concrete developments with real companies/tools. Be conservative with estimates. Quality over quantity - fewer real sources is better than many fake ones.`;\n\nexport const analysisPrompt = (json: string, userProfile?: any) => `\nYou are an expert AI risk analyst conducting a comprehensive, personalized career assessment. Use O3-style step-by-step reasoning to analyze this specific professional's unique situation.\n\n**INPUT DATA:** ${json}\n\n**USER PROFILE CONTEXT:**\n${userProfile ? `\n- Role: ${userProfile.role}\n- Experience Level: ${userProfile.yearsExperience}\n- Company Size: ${userProfile.companySize || 'Not specified'}\n- Daily Work Summary: ${userProfile.dailyWorkSummary?.slice(0, 500)}\n- Key Skills: ${userProfile.keySkills || 'Not specified'}\n- Resume/Background: ${userProfile.resume?.slice(0, 800)}\n- LinkedIn Profile: ${userProfile.linkedinData ? 'Analyzed' : 'Not provided'}\n` : 'Limited profile data available'}\n\n**REASONING METHODOLOGY:**\nApply step-by-step analysis with explicit reasoning traces:\n\n1. **Profile Analysis**: Examine the user's specific background, skills, and current role\n2. **Task Mapping**: Map their daily work to automation risk categories\n3. **Evidence Evaluation**: Assess research evidence against their specific context\n4. **Risk Calculation**: Apply weighted scoring based on their actual task distribution\n5. **Personalized Recommendations**: Generate advice specific to their career stage and skills\n\n**SCORING FORMULA:**\nCalculate risk score: S = Œ£(task_hours √ó risk_weight) / total_hours √ó 100\n- High Risk = 1.0 weight\n- Moderate Risk = 0.6 weight  \n- Low Risk = 0.3 weight\n\n**OUTPUT REQUIREMENTS:**\nGenerate exactly two sections separated by \"---FULL_REPORT---\":\n\n**SECTION 1: PREVIEW (Maximum 300 words)**\nCreate a polished, professional preview with:\n- Opening statement about AI transformation in their specific field/role\n- 3-4 key findings directly relevant to their background\n- Risk score with interpretation specific to their experience level\n- One immediately actionable tip based on their current skills\n- Inline citations using [1], [2], etc.\n\n**SECTION 2: FULL REPORT (Comprehensive Markdown)**\nGenerate a detailed, personalized markdown report with these sections:\n\n## Executive Summary\n- Brief overview of findings specific to this professional's background\n- How their experience level and company context affects risk\n- Key differentiators in their current role\n\n## Personalized Risk Assessment\n**Overall Risk Score: [X]/100 ([Risk Level])**\n\n### Your Specific Situation\n**Reasoning Trace:**\n1. **Current Role Analysis**: [Analyze their specific job title and responsibilities]\n2. **Experience Factor**: [How their years of experience affects automation risk]\n3. **Company Context**: [How their company size/type impacts risk timeline]\n4. **Skill Portfolio**: [Assessment of their current skills vs. automation trends]\n\n### Task-by-Task Analysis\nFor each of their reported tasks:\n- **[Specific Task from their daily work]** - Risk Level: High/Moderate/Low\n  - **Your Context**: How you currently perform this task\n  - **AI Capabilities**: Current automation tools affecting this work\n  - **Timeline**: When this might impact your specific role\n  - **Evidence**: Research findings [1]\n\n## Your Career Context Analysis\n### Background Assessment\n- **Professional Journey**: Analysis of their career progression\n- **Current Positioning**: Strengths and vulnerabilities in their role\n- **Industry Context**: How their specific industry/company type affects risk\n\n### Skills Gap Analysis\n**Your Current Skills vs. Future Needs:**\n- **Strengths to Leverage**: Skills that remain valuable\n- **Areas for Development**: Specific gaps to address\n- **Strategic Advantages**: Unique aspects of their background\n\n## Timeline & Impact Projections\n**For Your Specific Role:**\n\n**Immediate (0-12 months):**\n- Tools likely to affect your daily work\n- Immediate actions based on your current situation\n\n**Medium-term (1-3 years):**\n- Changes specific to your role and industry\n- Strategic positioning opportunities\n\n**Long-term (3-5 years):**\n- Transformation outlook for your career path\n- Evolution opportunities based on your background\n\n## Personalized Mitigation Strategies\n### High-Priority Actions (Based on Your Profile)\n1. **Skill Development**: Specific to your current level and background\n2. **Career Positioning**: Leveraging your existing experience\n3. **Industry Adaptation**: Relevant to your sector and company type\n\n### Your 90-Day Action Plan\n**Immediate Steps (Based on Your Current Role):**\n- [Specific actions relevant to their daily work]\n- [Skills to start developing given their background]\n- [Tools to explore in their current context]\n\n**Medium-term Goals (Leveraging Your Experience):**\n- [Career development specific to their experience level]\n- [Networking strategies for their industry]\n- [Skill certifications relevant to their field]\n\n### Recommended Focus Areas for [Their Role]\n- **Technical Skills**: Specific to their reported tools and tasks\n- **Strategic Capabilities**: Building on their experience level\n- **Industry Knowledge**: Deepening expertise in their sector\n- **Leadership/Management**: If appropriate for their experience level\n\n## Market Intelligence for Your Industry\n- **Adoption Rates**: In companies similar to theirs\n- **Competitive Landscape**: Relevant to their sector\n- **Investment Trends**: Affecting their industry specifically\n\n## Evidence-Based Reasoning\n### Research Evaluation Process\n1. **Relevance Assessment**: How each piece of evidence applies to their situation\n2. **Timeline Validation**: Realistic timelines given their industry context\n3. **Impact Probability**: Likelihood of affecting their specific role\n\n### Key Findings Interpretation\n**For Your Background:**\n- [Specific interpretation of research for their role]\n- [How general trends apply to their specific situation]\n- [Unique factors in their case]\n\n## Strategic Recommendations\n### Career Evolution Path\n**Building on Your [X] Years of Experience:**\n- **Short-term positioning** (6-12 months)\n- **Medium-term pivots** (1-2 years)  \n- **Long-term strategy** (3-5 years)\n\n### Competitive Differentiation\n**Your Unique Value Proposition:**\n- How to leverage current experience and skills\n- Areas where human expertise remains critical in their field\n- Strategic positioning for the AI era\n\n## 90-Day Action Plan\n### Phase 1: Immediate Actions (Days 1-30)\n**Skill Assessment & Foundation Building:**\n1. **Audit Current Skills**: Create inventory of technical and soft skills\n   - Complete LinkedIn Skills Assessment in [relevant areas]\n   - Use tools like [specific skill assessment platforms for their field]\n   - Document current proficiency levels\n\n2. **AI Tool Familiarization**: \n   - Start using [specific AI tools relevant to their role] daily\n   - Take free courses on [platform recommendations]\n   - Join [specific communities/forums for their field]\n\n3. **Network Activation**:\n   - Reach out to 5 professionals in AI-adjacent roles in your industry\n   - Join [specific professional groups/communities]\n   - Attend [relevant virtual events/webinars]\n\n**Resources:**\n- [LinkedIn Learning: Specific courses for their role]\n- [Coursera: AI specializations for their industry]\n- [Industry-specific forums and communities]\n\n### Phase 2: Skill Development (Days 31-60)\n**Strategic Capability Building:**\n1. **Core Competency Enhancement**:\n   - Enroll in [specific certification program]\n   - Practice [high-value skills that are harder to automate]\n   - Build portfolio showcasing [strategic thinking/creativity]\n\n2. **AI Collaboration Skills**:\n   - Learn prompt engineering for [their field]\n   - Understand AI limitations in [their area]\n   - Develop human-AI workflow optimization\n\n3. **Industry Intelligence**:\n   - Subscribe to [industry-specific AI newsletters]\n   - Follow key thought leaders: [specific names for their field]\n   - Monitor job postings for evolving skill requirements\n\n**Resources:**\n- [Professional certification programs]\n- [Industry-specific training platforms]\n- [Thought leader recommendations and resources]\n\n### Phase 3: Strategic Positioning (Days 61-90)\n**Career Future-Proofing:**\n1. **Specialized Expertise Development**:\n   - Focus on [specific niche areas with lower AI risk]\n   - Develop expertise in [human-centric aspects of their role]\n   - Create thought leadership content\n\n2. **Strategic Networking**:\n   - Establish mentorship relationships\n   - Speak at [industry events/webinars]\n   - Share insights on [professional platforms]\n\n3. **Portfolio/Profile Enhancement**:\n   - Update LinkedIn with new skills and AI knowledge\n   - Create case studies showing AI-human collaboration\n   - Develop personal brand around [strategic positioning]\n\n**Resources:**\n- [Speaking opportunities platforms]\n- [Content creation tools and platforms]\n- [Personal branding resources]\n\n## Skill Development Roadmap\n### Core Skills to Develop (Priority Order)\n1. **AI Collaboration & Prompt Engineering**\n   - **What**: Learn to effectively work with AI tools\n   - **Why**: Essential for staying relevant in AI-augmented workflows\n   - **How**: \n     - Complete [specific prompt engineering course]\n     - Practice with [relevant AI tools for their role]\n     - Join [prompt engineering communities]\n   - **Timeline**: 2-4 weeks\n   - **Resources**: \n     - [OpenAI Prompt Engineering Guide]\n     - [Specific course recommendations]\n     - [Tool-specific tutorials]\n\n2. **[Role-Specific Strategic Skill]**\n   - **What**: [Specific skill that leverages human judgment]\n   - **Why**: [Explanation of why this skill remains valuable]\n   - **How**: [Specific learning path and resources]\n   - **Timeline**: [Realistic timeframe]\n   - **Resources**: [Specific courses, books, platforms]\n\n3. **Data Analysis & Interpretation**\n   - **What**: Understanding and interpreting AI-generated insights\n   - **Why**: Critical for making strategic decisions with AI assistance\n   - **How**: [Learning path specific to their role]\n   - **Timeline**: 4-6 weeks\n   - **Resources**: [Specific analytics courses and tools]\n\n4. **[Industry-Specific Future Skill]**\n   - **What**: [Emerging skill in their field]\n   - **Why**: [Future market demand]\n   - **How**: [Specific development approach]\n   - **Timeline**: [Timeline]\n   - **Resources**: [Specific resources]\n\n### Learning Resources & Platforms\n**Free Resources:**\n- [Coursera: Specific free courses for their field]\n- [edX: Relevant specializations]\n- [YouTube: Curated channel recommendations]\n- [Podcasts: Industry-specific shows]\n\n**Paid Resources (High ROI):**\n- [Professional certification programs]\n- [Premium learning platforms]\n- [Industry conferences and workshops]\n- [Mentorship programs]\n\n**Books & Reading:**\n- [5-7 specific book recommendations for their field]\n- [Industry reports and whitepapers]\n- [Research publications relevant to AI in their sector]\n\n### Skill Measurement & Progress Tracking\n**Monthly Assessments:**\n- Complete skill assessments on [specific platforms]\n- Track project outcomes using new skills\n- Gather feedback from colleagues/supervisors\n- Update professional profiles with new competencies\n\n**Success Metrics:**\n- [Specific, measurable goals for their role]\n- Portfolio projects demonstrating new capabilities\n- Recognition or feedback from industry peers\n- Job market competitiveness indicators\n\n## Professional Development Network\n### Key Communities to Join\n1. **[Industry-Specific AI Groups]**\n   - LinkedIn: [Specific group names]\n   - Discord/Slack: [Community recommendations]\n   - Reddit: [Relevant subreddits]\n\n2. **Skill-Specific Communities**\n   - [Communities for emerging skills in their field]\n   - [Professional associations adapting to AI]\n\n3. **Thought Leadership Platforms**\n   - [Where to share insights and build reputation]\n   - [Speaking opportunity platforms]\n\n### Mentorship & Guidance\n**Finding Mentors:**\n- [Platforms for finding industry mentors]\n- [Networking strategies for their field]\n- [Professional associations with mentorship programs]\n\n**Reverse Mentoring:**\n- Mentor others in traditional skills while learning AI\n- Knowledge exchange opportunities\n- Building leadership reputation\n\n## Implementation Timeline\n### Month 1: Foundation\n- Complete initial skill assessments\n- Begin AI tool familiarization\n- Join key professional communities\n- Start first priority skill development\n\n### Month 2: Development  \n- Deepen technical skill development\n- Begin strategic networking\n- Apply learnings to current role\n- Measure progress and adjust\n\n### Month 3: Positioning\n- Showcase new capabilities\n- Establish thought leadership\n- Expand professional network\n- Plan long-term career strategy\n\n### Months 4-6: Advanced Development\n- [Extended roadmap for continued growth]\n- [Advanced skill development areas]\n- [Leadership opportunity development]\n- [Industry contribution goals]\n\n## Sources & References\n[1] [Source description with specific relevance to their role] - URL\n[2] [Source description] - URL\n[etc.]\n\n**CRITICAL REQUIREMENTS:**\n- Reference their specific daily tasks, skills, and background throughout\n- Make all recommendations contextual to their experience level and industry\n- Include step-by-step reasoning for risk assessments\n- Provide actionable advice specific to their current situation\n- Use their actual job title, company context, and reported skills\n- Show clear logical connections between evidence and their specific case\n- If insufficient personalization data: note limitations but provide best possible analysis\n\nGenerate the complete personalized analysis now:`;\n\nexport const linkedinPrompt = (profileData: string) => `\nYou are analyzing a LinkedIn profile to extract professional information for AI replacement risk assessment.\n\n**LINKEDIN PROFILE DATA:**\n${profileData}\n\n**EXTRACTION REQUIREMENTS:**\nExtract and structure the following information:\n\n{\n  \"personalInfo\": {\n    \"name\": \"full name\",\n    \"currentTitle\": \"current job title\",\n    \"company\": \"current company\",\n    \"location\": \"current location\"\n  },\n  \"experience\": {\n    \"yearsTotal\": \"total years of experience\",\n    \"currentRole\": {\n      \"title\": \"current position\",\n      \"company\": \"company name\", \n      \"duration\": \"time in current role\",\n      \"description\": \"role description and responsibilities\"\n    },\n    \"previousRoles\": [\n      {\n        \"title\": \"job title\",\n        \"company\": \"company name\",\n        \"duration\": \"time period\",\n        \"keyResponsibilities\": [\"responsibility1\", \"responsibility2\"]\n      }\n    ]\n  },\n  \"skills\": {\n    \"technical\": [\"technical skill 1\", \"technical skill 2\"],\n    \"soft\": [\"soft skill 1\", \"soft skill 2\"],\n    \"tools\": [\"tool 1\", \"tool 2\"],\n    \"certifications\": [\"cert 1\", \"cert 2\"]\n  },\n  \"education\": [\n    {\n      \"degree\": \"degree type\",\n      \"field\": \"field of study\", \n      \"institution\": \"school name\",\n      \"year\": \"graduation year\"\n    }\n  ],\n  \"dailyTasks\": \"inferred daily responsibilities based on current and recent roles\",\n  \"careerCategory\": \"best matching category: designer|product-manager|marketing|accounting|legal|other\",\n  \"companySize\": \"inferred company size: startup|small|medium|large\"\n}\n\nFocus on extracting concrete, specific information. If data is missing, mark as \"not_available\".`;\n\nexport const webBrowsePrompt = (linkedinUrl: string) => `\nBrowse this LinkedIn profile URL and extract comprehensive professional information: ${linkedinUrl}\n\nFocus on:\n1. Current job title and company\n2. Work experience and career progression  \n3. Skills and technical competencies\n4. Education and certifications\n5. Key responsibilities and achievements\n6. Industry and functional area\n\nReturn the extracted information in a structured format that can be used for AI replacement risk analysis.`; ","export function score(evidence: any): number {\n  if (!evidence || !evidence.taskFacts) {\n    return 0;\n  }\n\n  let totalScore = 0;\n  let totalHours = 0;\n\n  for (const task of evidence.taskFacts) {\n    const hours = task.hours || 1;\n    let weight = 0;\n\n    switch (task.riskRating) {\n      case 'High':\n        weight = 1;\n        break;\n      case 'Moderate':\n        weight = 0.6;\n        break;\n      case 'Low':\n        weight = 0.3;\n        break;\n      default:\n        weight = 0.5;\n    }\n\n    totalScore += hours * weight;\n    totalHours += hours;\n  }\n\n  if (totalHours === 0) {\n    return 0;\n  }\n\n  // Return as percentage (0-100)\n  return Math.round((totalScore / totalHours) * 100);\n} ","import { NextRequest, NextResponse } from 'next/server';\nimport { createClient } from '@supabase/supabase-js';\nimport OpenAI from 'openai';\nimport { analysisPrompt } from '@/server/promptTemplates';\nimport { score } from '@/server/score';\n\nexport const runtime = 'edge';\nexport const maxDuration = 800; // 13.33 minutes - maximum allowed for current Vercel plan\n\n// Function to sanitize text for database insertion\nfunction sanitizeText(text: string): string {\n  if (!text) return '';\n  \n  return text\n    // Remove null bytes and other problematic Unicode characters\n    .replace(/\\0/g, '')\n    // Normalize Unicode\n    .normalize('NFC')\n    // Limit length to prevent oversized content\n    .substring(0, 50000);\n}\n\nexport async function POST(req: NextRequest) {\n  console.log('üî¨ [Analyze API] Starting analysis request...');\n  \n  try {\n    const body = await req.json();\n    console.log('üìã [Analyze API] Request body keys:', Object.keys(body));\n    console.log('üìã [Analyze API] Profile ID:', body.profile_id);\n    console.log('üìã [Analyze API] Evidence type:', typeof body.evidence);\n    \n    const { profile_id, evidence } = body;\n\n    // Validate required fields\n    if (!profile_id) {\n      console.error('‚ùå [Analyze API] Missing profile_id');\n      return NextResponse.json({ error: 'Profile ID is required' }, { status: 400 });\n    }\n\n    if (!evidence) {\n      console.error('‚ùå [Analyze API] Missing evidence');\n      return NextResponse.json({ error: 'Evidence is required' }, { status: 400 });\n    }\n\n    console.log('üîó [Analyze API] Creating Supabase client...');\n    const supabase = createClient(\n      process.env.SUPABASE_URL!,\n      process.env.SUPABASE_SERVICE_ROLE_KEY!\n    );\n    console.log('‚úÖ [Analyze API] Supabase client created');\n\n    // Fetch user profile data for personalized analysis\n    console.log('üë§ [Analyze API] Fetching user profile data...');\n    const { data: profileData, error: profileError } = await supabase\n      .from('profiles')\n      .select('*')\n      .eq('id', profile_id)\n      .single();\n\n    if (profileError) {\n      console.error('‚ùå [Analyze API] Error fetching profile:', profileError);\n      return NextResponse.json({ error: 'Profile not found' }, { status: 404 });\n    }\n\n    console.log('‚úÖ [Analyze API] Profile data fetched:', {\n      role: profileData.role,\n      hasResume: !!profileData.resume,\n      taskCount: Object.keys(profileData.task_hours || {}).length,\n      hasProfileData: !!profileData.profile_data,\n      hasLinkedinData: !!profileData.linkedin_data\n    });\n\n    // Prepare enhanced user profile for analysis\n    const enhancedProfile = {\n      role: profileData.role,\n      resume: profileData.resume,\n      taskHours: profileData.task_hours,\n      // Extract from profile_data JSON\n      yearsExperience: profileData.profile_data?.yearsExperience,\n      companySize: profileData.profile_data?.companySize,\n      dailyWorkSummary: profileData.profile_data?.dailyWorkSummary,\n      keySkills: profileData.profile_data?.keySkills,\n      careerCategory: profileData.profile_data?.careerCategory,\n      linkedinUrl: profileData.profile_data?.linkedinUrl,\n      // Include LinkedIn analysis if available\n      linkedinData: profileData.linkedin_data,\n      createdAt: profileData.created_at\n    };\n\n    console.log('ü§ñ [Analyze API] Creating OpenAI client...');\n    const openai = new OpenAI({ \n      apiKey: process.env.OPENAI_API_KEY,\n      timeout: 300000 // 5 minutes timeout instead of 60 seconds\n    });\n\n    console.log('üìù [Analyze API] Generating enhanced analysis prompt with user context...');\n    const prompt = analysisPrompt(JSON.stringify(evidence), enhancedProfile);\n    console.log('üìÑ [Analyze API] Enhanced prompt length:', prompt.length);\n\n    console.log('üöÄ [Analyze API] Calling OpenAI Responses API with Web Search + Enhanced Parsing...');\n    \n    const analysis = await openai.responses.create({\n      model: \"gpt-4.1\",\n      tools: [{\"type\": \"web_search_preview\"}],\n      input: [{\n        role: \"user\", \n        content: [{\n          type: \"input_text\",\n          text: `${prompt}\n\n**ENHANCED ANALYSIS WITH WEB SEARCH:**\nUse web search to find the most current information to enhance this personalized career risk analysis:\n\n1. Search for latest 2024-2025 developments in AI automation for: \"${enhancedProfile.role}\"\n2. Find recent salary and job market trends for this role\n3. Look up current skills in demand for career advancement\n4. Search for real case studies of AI implementation in this industry\n5. Find current certification programs and learning resources\n\nIncorporate these real-time insights into the comprehensive analysis.\n\n**REQUIRED OUTPUT FORMAT:**\nThe response must contain exactly two sections separated by \"---FULL_REPORT---\":\n\n1. PREVIEW SECTION (before the separator):\n   - Maximum 300 words\n   - Professional preview with key insights\n   - Risk score interpretation\n   - One actionable tip\n   - Inline citations using [1], [2], etc.\n\n2. FULL REPORT SECTION (after the separator):\n   - Complete comprehensive markdown analysis\n   - All required sections with web search insights\n   - Enhanced with current market data\n\nExample format:\n[Preview content here...]\n\n---FULL_REPORT---\n\n[Full comprehensive report here...]\n\nEnsure both sections incorporate current web search findings for accuracy and relevance.`\n        }]\n      }]\n    });\n\n    console.log('‚úÖ [Analyze API] OpenAI response received with web search + enhanced parsing');\n\n    const responseContent = analysis.output_text;\n    if (!responseContent) {\n      console.error('‚ùå [Analyze API] No response content received from analysis');\n      return NextResponse.json({ error: 'No analysis response received' }, { status: 500 });\n    }\n\n    console.log('üîß [Analyze API] Splitting response into preview and full report...');\n    const [preview, fullReport] = responseContent.split('---FULL_REPORT---');\n    console.log('üìÑ [Analyze API] Preview length:', preview?.length);\n    console.log('üìÑ [Analyze API] Full report length:', fullReport?.length);\n\n    // Sanitize the text outputs\n    const sanitizedPreview = sanitizeText(preview?.trim() || 'Analysis preview not available');\n    const sanitizedFullReport = sanitizeText(fullReport?.trim() || 'Full report not available');\n\n    console.log('üßÆ [Analyze API] Calculating risk score...');\n    const scoreVal = score(evidence);\n    console.log('üìä [Analyze API] Calculated score:', scoreVal);\n\n    console.log('üíæ [Analyze API] Saving report to database...');\n    const { data: report, error: dbError } = await supabase\n      .from('reports')\n      .insert([{\n        profile_id,\n        score: scoreVal,\n        preview: sanitizedPreview,\n        full_report: sanitizedFullReport,\n        evidence: evidence\n      }])\n      .select()\n      .single();\n\n    if (dbError) {\n      console.error('‚ùå [Analyze API] Database error:', dbError);\n      return NextResponse.json({ error: 'Database error: ' + dbError.message }, { status: 500 });\n    }\n\n    console.log('‚úÖ [Analyze API] Report saved successfully:', report?.id);\n    console.log('‚úÖ [Analyze API] Analysis completed successfully');\n\n    return NextResponse.json({ ok: true, report_id: report?.id });\n\n  } catch (error) {\n    console.error('üí• [Analyze API] Unexpected error:', error);\n    console.error('üìö [Analyze API] Error stack:', error instanceof Error ? error.stack : 'No stack trace');\n    return NextResponse.json(\n      { error: 'Analysis failed: ' + (error instanceof Error ? error.message : String(error)) }, \n      { status: 500 }\n    );\n  }\n} "],"names":["researchPrompt","role","tasks","resume","linkedinData","profileData","JSON","stringify","slice","json","userProfile","yearsExperience","companySize","dailyWorkSummary","keySkills","runtime","sanitizeText","text","normalize","substring","POST","req","console","log","body","Object","keys","profile_id","evidence","error","NextResponse","status","supabase","createClient","process","env","SUPABASE_URL","SUPABASE_SERVICE_ROLE_KEY","data","profileError","from","select","eq","single","hasResume","taskCount","task_hours","length","hasProfileData","profile_data","hasLinkedinData","linkedin_data","enhancedProfile","taskHours","careerCategory","linkedinUrl","createdAt","created_at","openai","OpenAI","apiKey","OPENAI_API_KEY","timeout","prompt","analysisPrompt","analysis","responses","create","model","tools","input","content","type","responseContent","output_text","preview","fullReport","split","sanitizedPreview","trim","sanitizedFullReport","scoreVal","score","taskFacts","totalScore","totalHours","task","hours","weight","riskRating","Math","round","report","dbError","insert","full_report","message","id","ok","report_id","Error","stack","String"],"sourceRoot":"","ignoreList":[]}